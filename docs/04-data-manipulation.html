<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Manipulando datos</title>

<script src="site_libs/header-attrs-2.26/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Seminario de Aplicación</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="prepare.html">Antes de comenzar</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Temas
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01-introduction.html">Introducción y reportes</a>
    </li>
    <li>
      <a href="02-reading-data.html">Leyendo datos</a>
    </li>
    <li>
      <a href="03-plotting-data.html">Graficando datos</a>
    </li>
    <li>
      <a href="04-data-manipulation.html">Maninpulación de datos</a>
    </li>
    <li>
      <a href="05-reports.html">Comunicando nuestro trabajo</a>
    </li>
  </ul>
</li>
<li>
  <a href="reporte_cultivares.html">Ejemplo</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/yabellini/AgroReportesConR">Repo</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Manipulando datos</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#creando-tablas-de-resumen"
id="toc-creando-tablas-de-resumen">Creando tablas de resumen</a></li>
<li><a href="#dándole-formato-a-la-tabla"
id="toc-dándole-formato-a-la-tabla">Dándole formato a la tabla</a></li>
<li><a href="#creando-nuevas-variables"
id="toc-creando-nuevas-variables">Creando nuevas variables</a></li>
<li><a href="#filtrando-los-datos"
id="toc-filtrando-los-datos">Filtrando los datos</a></li>
</ul>
</div>

<div id="creando-tablas-de-resumen" class="section level2">
<h2>Creando tablas de resumen</h2>
<p>En una hoja de cálculo, las tablas dinámicas o pivot tables son
potentes herramientas para resumir los datos de diferentes maneras.
Podemos crear estas tablas utilizando las funciones
<code>group_by</code> y <code>summarize</code> del paquete dplyr.</p>
<p>Echemos un vistazo a nuestro informe, justo después de leer los
datos, creamos una tabla de resumen con el número de ensayos y el
rendimiento media de cada cultivar de nuestro conjunto de datos.</p>
<p>Podemos utilizar <code>group_by()</code> para agrupar nuestros datos
por <strong>cultivar</strong> y <code>summarize()</code> para calcular
el número de ensayos y el <strong>rendimiento_ajustado</strong> medio
para cada grupo.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>cultivares <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="fu">group_by</span>(Cultivar) <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cantidad =</span> <span class="fu">n</span>(),</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>            <span class="at">rendimiento_ajustado_medio =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Rendimiento_Ajustado, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## # A tibble: 19 × 3
##    Cultivar        cantidad rendimiento_ajustado_medio
##    &lt;chr&gt;              &lt;int&gt;                      &lt;dbl&gt;
##  1 ACA 203                3                      2309 
##  2 ACA 203 CL            57                      3089.
##  3 ACA 203 CL DM          3                      3771.
##  4 ACA 211 CL             9                      2870.
##  5 ACA 350 CL PLUS       18                      3439.
##  6 ACA 769                1                      3744 
##  7 ACA 861              185                      3004.
##  8 ACA 862                1                      3483 
##  9 ACA 862 HO            14                      2673.
## 10 ACA 863               82                      3022.
## 11 ACA 864 DM            31                      3474.
## 12 ACA 865               12                      3256.
## 13 ACA 866 HO            21                      2846.
## 14 ACA 867               43                      3394.
## 15 ACA 868 HO            15                      3645.
## 16 ACA 876                1                      1691 
## 17 ACA 884                1                      1654 
## 18 ACA 885                1                      1574 
## 19 ACA 886                1                      1588</code></pre>
<p>La función <code>n()</code> devuelve el número de casos y la función
<code>mean</code> calcula la media o promedio. El parámetro
<code>na.rm = TRUE</code> indica a la función que elimine los valores
faltantes (<code>NA</code>) antes de realizar el cálculo.</p>
<blockquote>
<p>Pregunta: ¿Qué pasa si no se utiliza <code>group_by()</code> antes de
<code>summarise()</code>? Probémoslo y discutamos lo que ocurre.</p>
</blockquote>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>cultivares <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cantidad =</span> <span class="fu">n</span>(),</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>            <span class="at">rendimiento_ajustado_medio =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Rendimiento_Ajustado, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   cantidad rendimiento_ajustado_medio
##      &lt;int&gt;                      &lt;dbl&gt;
## 1      499                      3094.</code></pre>
<p>Así que si no agrupamos por el cultivar primero, obtendremos una sola
estadística de resumen (n y media en este caso) para todo el conjunto de
datos.</p>
<p>Ahora, queremos la media del rendimiento en toneladas y con dos
decimales. Podemos cambiar nuestra llamada a <code>summarise()</code>
para obtener ese cálculo.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>cultivares <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="fu">group_by</span>(Cultivar) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cantidad =</span> <span class="fu">n</span>(),</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>            <span class="at">rendimiento_ajustado_medio =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Rendimiento_Ajustado<span class="sc">/</span><span class="dv">1000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## # A tibble: 19 × 3
##    Cultivar        cantidad rendimiento_ajustado_medio
##    &lt;chr&gt;              &lt;int&gt;                      &lt;dbl&gt;
##  1 ACA 203                3                       2.31
##  2 ACA 203 CL            57                       3.09
##  3 ACA 203 CL DM          3                       3.77
##  4 ACA 211 CL             9                       2.87
##  5 ACA 350 CL PLUS       18                       3.44
##  6 ACA 769                1                       3.74
##  7 ACA 861              185                       3   
##  8 ACA 862                1                       3.48
##  9 ACA 862 HO            14                       2.67
## 10 ACA 863               82                       3.02
## 11 ACA 864 DM            31                       3.47
## 12 ACA 865               12                       3.26
## 13 ACA 866 HO            21                       2.85
## 14 ACA 867               43                       3.39
## 15 ACA 868 HO            15                       3.65
## 16 ACA 876                1                       1.69
## 17 ACA 884                1                       1.65
## 18 ACA 885                1                       1.57
## 19 ACA 886                1                       1.59</code></pre>
<p>Primero dividimos el rendimiento ajustado por 1000 para transformarlo
de kilogramos a toneladas y luego utilizamos la función
<code>round()</code> para redondear a sólo dos decimales.</p>
<p>Ahora estamos en el punto en el que queremos guardar esta información
resumida como una variable para poder utilizarla en posteriores análisis
y formatos.</p>
<p>Así que vamos a añadir una asignación de variable a esa primera
línea:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>resumen <span class="ot">&lt;-</span> cultivares <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">group_by</span>(Cultivar) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cantidad =</span> <span class="fu">n</span>(),</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>            <span class="at">rendimiento_ajustado_medio =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Rendimiento_Ajustado<span class="sc">/</span><span class="dv">1000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>))</span></code></pre></div>
</div>
<div id="dándole-formato-a-la-tabla" class="section level2">
<h2>Dándole formato a la tabla</h2>
<p>Para que nuestra tabla se vea mejor en un informe, tenemos que
cambiar algunos de sus elementos. Por ejemplo, el nombre de las
variables debe ser informativo para una persona (de momento son nombres
útiles para una computadora), y podemos añadirle un título y cambiar la
alineación de los números.</p>
<p>Podemos hacerlo con la función <code>kable</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>resumen <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Cultivar&quot;</span>, <span class="st">&quot;Cantidad&quot;</span>, <span class="st">&quot;Rendimiento Ajustado Medio&quot;</span>),</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>               <span class="at">align =</span> <span class="st">&quot;lcc&quot;</span>,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">&quot;Resumen de los Cultivares en el dataset.&quot;</span>)</span></code></pre></div>
<table>
<caption>Resumen de los Cultivares en el dataset.</caption>
<thead>
<tr class="header">
<th align="left">Cultivar</th>
<th align="center">Cantidad</th>
<th align="center">Rendimiento Ajustado Medio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ACA 203</td>
<td align="center">3</td>
<td align="center">2.31</td>
</tr>
<tr class="even">
<td align="left">ACA 203 CL</td>
<td align="center">57</td>
<td align="center">3.09</td>
</tr>
<tr class="odd">
<td align="left">ACA 203 CL DM</td>
<td align="center">3</td>
<td align="center">3.77</td>
</tr>
<tr class="even">
<td align="left">ACA 211 CL</td>
<td align="center">9</td>
<td align="center">2.87</td>
</tr>
<tr class="odd">
<td align="left">ACA 350 CL PLUS</td>
<td align="center">18</td>
<td align="center">3.44</td>
</tr>
<tr class="even">
<td align="left">ACA 769</td>
<td align="center">1</td>
<td align="center">3.74</td>
</tr>
<tr class="odd">
<td align="left">ACA 861</td>
<td align="center">185</td>
<td align="center">3.00</td>
</tr>
<tr class="even">
<td align="left">ACA 862</td>
<td align="center">1</td>
<td align="center">3.48</td>
</tr>
<tr class="odd">
<td align="left">ACA 862 HO</td>
<td align="center">14</td>
<td align="center">2.67</td>
</tr>
<tr class="even">
<td align="left">ACA 863</td>
<td align="center">82</td>
<td align="center">3.02</td>
</tr>
<tr class="odd">
<td align="left">ACA 864 DM</td>
<td align="center">31</td>
<td align="center">3.47</td>
</tr>
<tr class="even">
<td align="left">ACA 865</td>
<td align="center">12</td>
<td align="center">3.26</td>
</tr>
<tr class="odd">
<td align="left">ACA 866 HO</td>
<td align="center">21</td>
<td align="center">2.85</td>
</tr>
<tr class="even">
<td align="left">ACA 867</td>
<td align="center">43</td>
<td align="center">3.39</td>
</tr>
<tr class="odd">
<td align="left">ACA 868 HO</td>
<td align="center">15</td>
<td align="center">3.65</td>
</tr>
<tr class="even">
<td align="left">ACA 876</td>
<td align="center">1</td>
<td align="center">1.69</td>
</tr>
<tr class="odd">
<td align="left">ACA 884</td>
<td align="center">1</td>
<td align="center">1.65</td>
</tr>
<tr class="even">
<td align="left">ACA 885</td>
<td align="center">1</td>
<td align="center">1.57</td>
</tr>
<tr class="odd">
<td align="left">ACA 886</td>
<td align="center">1</td>
<td align="center">1.59</td>
</tr>
</tbody>
</table>
<p>Podemos hacer mucho más con otras funciones (o “verbos”) de dplyr.
Veamos algunos más.</p>
</div>
<div id="creando-nuevas-variables" class="section level2">
<h2>Creando nuevas variables</h2>
<p>Muchas veces querremos trabajar con información que se deriva de los
datos originales. Esto se suele hacer añadiendo una nueva columna. Lo
hacemos con la función <code>mutate()</code>.</p>
<p>Podemos añadir una nueva variable (llamada <code>prop</code>) que
represente la proporción de ensayos en cada <strong>localidad</strong>
con el uso de <code>mutate()</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>cultivares <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">group_by</span>(Localidad) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cantidad =</span> <span class="fu">n</span>(),</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>            <span class="at">rendimiento_ajustado_medio =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Rendimiento_Ajustado, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> cantidad<span class="sc">/</span><span class="fu">nrow</span>(cultivares))</span></code></pre></div>
<pre><code>## # A tibble: 58 × 4
##    Localidad cantidad rendimiento_ajustado_medio    prop
##    &lt;chr&gt;        &lt;int&gt;                      &lt;dbl&gt;   &lt;dbl&gt;
##  1 Anguil          21                      3156. 0.0421 
##  2 Ascasubi         5                      4996. 0.0100 
##  3 Asturias         7                      4216. 0.0140 
##  4 Balcarce        59                      2856. 0.118  
##  5 Barrow          34                      2665. 0.0681 
##  6 Bellocq         31                      3899. 0.0621 
##  7 Bolívar          5                      3931  0.0100 
##  8 Bordenave        3                      4624  0.00601
##  9 Bulnes          11                      2980. 0.0220 
## 10 Carhue           2                      2879  0.00401
## # ℹ 48 more rows</code></pre>
</div>
<div id="filtrando-los-datos" class="section level2">
<h2>Filtrando los datos</h2>
<p>En nuestro informe también realizamos un gráfico de un cultivar
específico. Para ello necesitamos mantener sólo los datos del cultivar
que queremos analizar. Utilizamos la función <code>filter()</code> para
filtrar filas de un data.frame, esta función devuelve un nuevo
data.frame con sólo las filas que satisfacen algunas condiciones.</p>
<p>Podemos utilizar operadores lógicos (<code>&gt;</code>,
<code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>,
<code>==</code>) para crear condiciones a partir de variables numéricas.
Estos operadores también son útiles para fechas y cadenas de texto. El
siguiente código aplica una condición (“que sea igual a”) para datos de
tipo texto (la columna especie).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>cultivares <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">filter</span>(Cultivar <span class="sc">==</span> <span class="st">&quot;ACA 861&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 185 × 21
##    Cultivar Empresa Floracion_dias Altura_cm Densidad_sem Rendimiento
##    &lt;chr&gt;    &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
##  1 ACA 861  ACA                 62       181        66229        4571
##  2 ACA 861  ACA                 68       129        53345        2598
##  3 ACA 861  ACA                 74       149        54286        2902
##  4 ACA 861  ACA                 73       156        42682        3097
##  5 ACA 861  ACA                 61       155        44818        3316
##  6 ACA 861  ACA                 68        NA        44193        4140
##  7 ACA 861  ACA                 69       167        40001        4201
##  8 ACA 861  ACA                 69       168        40650        3200
##  9 ACA 861  ACA                 72       173        56260        3858
## 10 ACA 861  ACA                 71        NA        52858        4464
## # ℹ 175 more rows
## # ℹ 15 more variables: Aceite_porcentaje &lt;dbl&gt;, Rendimiento_Ajustado &lt;dbl&gt;,
## #   Campania &lt;chr&gt;, Localidad &lt;chr&gt;, Latitud &lt;dbl&gt;, Longitud &lt;dbl&gt;,
## #   Ensayo &lt;chr&gt;, `Tipo Ensayo` &lt;chr&gt;, Epoca &lt;chr&gt;, Distancia_surcos &lt;dbl&gt;,
## #   Tipo_Siembra &lt;chr&gt;, Densidad_siembra &lt;dbl&gt;, Fecha_Siembra &lt;chr&gt;,
## #   Testigo &lt;chr&gt;, Visible &lt;chr&gt;</code></pre>
<blockquote>
<p>Actividad: Escribe el código necesario para filtrar todos los ensayos
de la localidad Anguil.</p>
</blockquote>
<blockquote>
<p>Actividad: Ahora escribe el código para filtrar todos los cultivares
con un rendimiento mayor a 5000 kg/ha.</p>
</blockquote>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIk1hbmlwdWxhbmRvIGRhdG9zIg0Kb3V0cHV0OiANCiAgaHRtbF9kb2N1bWVudDoNCiAgICBjb2RlX2Rvd25sb2FkOiB0cnVlDQogICAgdG9jOiB0cnVlDQogICAgdG9jX2Zsb2F0OiBmYWxzZQ0KICAgIGhpZ2hsaWdodDogdGFuZ28NCi0tLQ0KDQpgYGB7ciBzZXR1cCwgaW5jbHVkZT1GQUxTRX0NCmtuaXRyOjpvcHRzX2NodW5rJHNldCgNCgllY2hvID0gVFJVRSwNCgltZXNzYWdlID0gRkFMU0UsDQoJd2FybmluZyA9IEZBTFNFDQopDQoNCmxpYnJhcnkodGlkeXZlcnNlKQ0KY3VsdGl2YXJlcyA8LSByZWFkX2NzdigiZGF0b3MvUk5HX3NtYWxsLmNzdiIpDQpgYGANCg0KIyMgQ3JlYW5kbyB0YWJsYXMgZGUgcmVzdW1lbg0KDQpFbiB1bmEgaG9qYSBkZSBjw6FsY3VsbywgbGFzIHRhYmxhcyBkaW7DoW1pY2FzIG8gcGl2b3QgdGFibGVzIHNvbiBwb3RlbnRlcyBoZXJyYW1pZW50YXMgcGFyYSByZXN1bWlyIGxvcyBkYXRvcyBkZSBkaWZlcmVudGVzIG1hbmVyYXMuIFBvZGVtb3MgY3JlYXIgZXN0YXMgdGFibGFzIHV0aWxpemFuZG8gbGFzIGZ1bmNpb25lcyBgZ3JvdXBfYnlgIHkgYHN1bW1hcml6ZWAgZGVsIHBhcXVldGUgZHBseXIuIA0KDQpFY2hlbW9zIHVuIHZpc3Rhem8gYSBudWVzdHJvIGluZm9ybWUsIGp1c3RvIGRlc3B1w6lzIGRlIGxlZXIgbG9zIGRhdG9zLCBjcmVhbW9zIHVuYSB0YWJsYSBkZSByZXN1bWVuIGNvbiBlbCBuw7ptZXJvIGRlIGVuc2F5b3MgeSBlbCByZW5kaW1pZW50byBtZWRpYSBkZSBjYWRhIGN1bHRpdmFyIGRlIG51ZXN0cm8gY29uanVudG8gZGUgZGF0b3MuDQoNClBvZGVtb3MgdXRpbGl6YXIgYGdyb3VwX2J5KClgIHBhcmEgYWdydXBhciBudWVzdHJvcyBkYXRvcyBwb3IgKipjdWx0aXZhcioqIHkgYHN1bW1hcml6ZSgpYCBwYXJhIGNhbGN1bGFyIGVsIG7Dum1lcm8gZGUgZW5zYXlvcyB5IGVsICoqcmVuZGltaWVudG9fYWp1c3RhZG8qKiBtZWRpbyBwYXJhIGNhZGEgZ3J1cG8uDQoNCmBgYHtyfQ0KDQpjdWx0aXZhcmVzICU+JSANCiAgZ3JvdXBfYnkoQ3VsdGl2YXIpICU+JSANCiAgc3VtbWFyaXNlKGNhbnRpZGFkID0gbigpLA0KICAgICAgICAgICAgcmVuZGltaWVudG9fYWp1c3RhZG9fbWVkaW8gPSByb3VuZChtZWFuKFJlbmRpbWllbnRvX0FqdXN0YWRvLCBuYS5ybSA9IFRSVUUpLCAyKSkNCg0KYGBgDQoNCkxhIGZ1bmNpw7NuIGBuKClgIGRldnVlbHZlIGVsIG7Dum1lcm8gZGUgY2Fzb3MgeSBsYSBmdW5jacOzbiBgbWVhbmAgY2FsY3VsYSBsYSBtZWRpYSBvIHByb21lZGlvLiBFbCBwYXLDoW1ldHJvIGBuYS5ybSA9IFRSVUVgIGluZGljYSBhIGxhIGZ1bmNpw7NuIHF1ZSBlbGltaW5lIGxvcyB2YWxvcmVzIGZhbHRhbnRlcyAoYE5BYCkgYW50ZXMgZGUgcmVhbGl6YXIgZWwgY8OhbGN1bG8uDQoNCj4gUHJlZ3VudGE6IMK/UXXDqSBwYXNhIHNpIG5vIHNlIHV0aWxpemEgYGdyb3VwX2J5KClgIGFudGVzIGRlIGBzdW1tYXJpc2UoKWA/IFByb2LDqW1vc2xvIHkgZGlzY3V0YW1vcyBsbyBxdWUgb2N1cnJlLg0KDQpgYGB7cn0NCmN1bHRpdmFyZXMgJT4lIA0KICBzdW1tYXJpc2UoY2FudGlkYWQgPSBuKCksDQogICAgICAgICAgICByZW5kaW1pZW50b19hanVzdGFkb19tZWRpbyA9IHJvdW5kKG1lYW4oUmVuZGltaWVudG9fQWp1c3RhZG8sIG5hLnJtID0gVFJVRSksIDIpKQ0KYGBgDQoNCkFzw60gcXVlIHNpIG5vIGFncnVwYW1vcyBwb3IgZWwgY3VsdGl2YXIgcHJpbWVybywgb2J0ZW5kcmVtb3MgdW5hIHNvbGEgZXN0YWTDrXN0aWNhIGRlIHJlc3VtZW4gKG4geSBtZWRpYSBlbiBlc3RlIGNhc28pIHBhcmEgdG9kbyBlbCBjb25qdW50byBkZSBkYXRvcy4NCg0KQWhvcmEsIHF1ZXJlbW9zIGxhIG1lZGlhIGRlbCByZW5kaW1pZW50byBlbiB0b25lbGFkYXMgeSBjb24gZG9zIGRlY2ltYWxlcy4gUG9kZW1vcyBjYW1iaWFyIG51ZXN0cmEgbGxhbWFkYSBhIGBzdW1tYXJpc2UoKWAgcGFyYSBvYnRlbmVyIGVzZSBjw6FsY3Vsby4gIA0KDQpgYGB7cn0NCmN1bHRpdmFyZXMgJT4lIA0KICBncm91cF9ieShDdWx0aXZhcikgJT4lIA0KICBzdW1tYXJpc2UoY2FudGlkYWQgPSBuKCksDQogICAgICAgICAgICByZW5kaW1pZW50b19hanVzdGFkb19tZWRpbyA9IHJvdW5kKG1lYW4oUmVuZGltaWVudG9fQWp1c3RhZG8vMTAwMCwgbmEucm0gPSBUUlVFKSwgMikpDQoNCmBgYA0KDQpQcmltZXJvIGRpdmlkaW1vcyBlbCByZW5kaW1pZW50byBhanVzdGFkbyBwb3IgMTAwMCBwYXJhIHRyYW5zZm9ybWFybG8gZGUga2lsb2dyYW1vcyBhIHRvbmVsYWRhcyB5IGx1ZWdvIHV0aWxpemFtb3MgbGEgZnVuY2nDs24gYHJvdW5kKClgIHBhcmEgcmVkb25kZWFyIGEgc8OzbG8gZG9zIGRlY2ltYWxlcy4NCg0KQWhvcmEgZXN0YW1vcyBlbiBlbCBwdW50byBlbiBlbCBxdWUgcXVlcmVtb3MgZ3VhcmRhciBlc3RhIGluZm9ybWFjacOzbiByZXN1bWlkYSBjb21vIHVuYSB2YXJpYWJsZSBwYXJhIHBvZGVyIHV0aWxpemFybGEgZW4gcG9zdGVyaW9yZXMgYW7DoWxpc2lzIHkgZm9ybWF0b3MuDQoNCkFzw60gcXVlIHZhbW9zIGEgYcOxYWRpciB1bmEgYXNpZ25hY2nDs24gZGUgdmFyaWFibGUgYSBlc2EgcHJpbWVyYSBsw61uZWE6DQoNCmBgYHtyfQ0KcmVzdW1lbiA8LSBjdWx0aXZhcmVzICU+JSANCiAgZ3JvdXBfYnkoQ3VsdGl2YXIpICU+JSANCiAgc3VtbWFyaXNlKGNhbnRpZGFkID0gbigpLA0KICAgICAgICAgICAgcmVuZGltaWVudG9fYWp1c3RhZG9fbWVkaW8gPSByb3VuZChtZWFuKFJlbmRpbWllbnRvX0FqdXN0YWRvLzEwMDAsIG5hLnJtID0gVFJVRSksIDIpKQ0KYGBgDQoNCiMjIETDoW5kb2xlIGZvcm1hdG8gYSBsYSB0YWJsYQ0KDQpQYXJhIHF1ZSBudWVzdHJhIHRhYmxhIHNlIHZlYSBtZWpvciBlbiB1biBpbmZvcm1lLCB0ZW5lbW9zIHF1ZSBjYW1iaWFyIGFsZ3Vub3MgZGUgc3VzIGVsZW1lbnRvcy4gUG9yIGVqZW1wbG8sIGVsIG5vbWJyZSBkZSBsYXMgdmFyaWFibGVzIGRlYmUgc2VyIGluZm9ybWF0aXZvIHBhcmEgdW5hIHBlcnNvbmEgKGRlIG1vbWVudG8gc29uIG5vbWJyZXMgw7p0aWxlcyBwYXJhIHVuYSBjb21wdXRhZG9yYSksIHkgcG9kZW1vcyBhw7FhZGlybGUgdW4gdMOtdHVsbyB5IGNhbWJpYXIgbGEgYWxpbmVhY2nDs24gZGUgbG9zIG7Dum1lcm9zLg0KDQpQb2RlbW9zIGhhY2VybG8gY29uIGxhIGZ1bmNpw7NuIGBrYWJsZWAuDQoNCmBgYHtyfQ0KcmVzdW1lbiAlPiUgDQogIGtuaXRyOjprYWJsZShjb2wubmFtZXMgPSBjKCJDdWx0aXZhciIsICJDYW50aWRhZCIsICJSZW5kaW1pZW50byBBanVzdGFkbyBNZWRpbyIpLA0KICAgICAgICAgICAgICAgYWxpZ24gPSAibGNjIiwNCiAgICAgICAgICAgICAgIGNhcHRpb24gPSAiUmVzdW1lbiBkZSBsb3MgQ3VsdGl2YXJlcyBlbiBlbCBkYXRhc2V0LiIpDQpgYGANCg0KUG9kZW1vcyBoYWNlciBtdWNobyBtw6FzIGNvbiBvdHJhcyBmdW5jaW9uZXMgKG8gInZlcmJvcyIpIGRlIGRwbHlyLiBWZWFtb3MgYWxndW5vcyBtw6FzLg0KDQojIyBDcmVhbmRvIG51ZXZhcyB2YXJpYWJsZXMNCg0KTXVjaGFzIHZlY2VzIHF1ZXJyZW1vcyB0cmFiYWphciBjb24gaW5mb3JtYWNpw7NuIHF1ZSBzZSBkZXJpdmEgZGUgbG9zIGRhdG9zIG9yaWdpbmFsZXMuIEVzdG8gc2Ugc3VlbGUgaGFjZXIgYcOxYWRpZW5kbyB1bmEgbnVldmEgY29sdW1uYS4gTG8gaGFjZW1vcyBjb24gbGEgZnVuY2nDs24gYG11dGF0ZSgpYC4NCg0KUG9kZW1vcyBhw7FhZGlyIHVuYSBudWV2YSB2YXJpYWJsZSAobGxhbWFkYSBgcHJvcGApIHF1ZSByZXByZXNlbnRlIGxhIHByb3BvcmNpw7NuIGRlIGVuc2F5b3MgZW4gY2FkYSAqKmxvY2FsaWRhZCoqIGNvbiBlbCB1c28gZGUgYG11dGF0ZSgpYC4gDQoNCmBgYHtyfQ0KDQpjdWx0aXZhcmVzICU+JSANCiAgZ3JvdXBfYnkoTG9jYWxpZGFkKSAlPiUgDQogIHN1bW1hcmlzZShjYW50aWRhZCA9IG4oKSwNCiAgICAgICAgICAgIHJlbmRpbWllbnRvX2FqdXN0YWRvX21lZGlvID0gcm91bmQobWVhbihSZW5kaW1pZW50b19BanVzdGFkbywgbmEucm0gPSBUUlVFKSwgMikpICU+JQ0KICBtdXRhdGUocHJvcCA9IGNhbnRpZGFkL25yb3coY3VsdGl2YXJlcykpDQoNCmBgYA0KDQojIyBGaWx0cmFuZG8gbG9zIGRhdG9zDQoNCkVuIG51ZXN0cm8gaW5mb3JtZSB0YW1iacOpbiByZWFsaXphbW9zIHVuIGdyw6FmaWNvIGRlIHVuIGN1bHRpdmFyIGVzcGVjw61maWNvLiBQYXJhIGVsbG8gbmVjZXNpdGFtb3MgbWFudGVuZXIgc8OzbG8gbG9zIGRhdG9zIGRlbCBjdWx0aXZhciBxdWUgcXVlcmVtb3MgYW5hbGl6YXIuICBVdGlsaXphbW9zIGxhIGZ1bmNpw7NuIGBmaWx0ZXIoKWAgcGFyYSBmaWx0cmFyIGZpbGFzIGRlIHVuIGRhdGEuZnJhbWUsIGVzdGEgZnVuY2nDs24gZGV2dWVsdmUgdW4gbnVldm8gZGF0YS5mcmFtZSBjb24gc8OzbG8gbGFzIGZpbGFzIHF1ZSBzYXRpc2ZhY2VuIGFsZ3VuYXMgY29uZGljaW9uZXMuDQoNClBvZGVtb3MgdXRpbGl6YXIgb3BlcmFkb3JlcyBsw7NnaWNvcyAoYD5gLCBgPGAsIGA+PWAsIGA8PWAsIGA9PWApIHBhcmEgY3JlYXIgY29uZGljaW9uZXMgYSBwYXJ0aXIgZGUgdmFyaWFibGVzIG51bcOpcmljYXMuIEVzdG9zIG9wZXJhZG9yZXMgdGFtYmnDqW4gc29uIMO6dGlsZXMgcGFyYSBmZWNoYXMgeSBjYWRlbmFzIGRlIHRleHRvLiBFbCBzaWd1aWVudGUgY8OzZGlnbyBhcGxpY2EgdW5hIGNvbmRpY2nDs24gKCJxdWUgc2VhIGlndWFsIGEiKSBwYXJhIGRhdG9zIGRlIHRpcG8gdGV4dG8gKGxhIGNvbHVtbmEgZXNwZWNpZSkuDQoNCmBgYHtyfQ0KY3VsdGl2YXJlcyAlPiUgDQogIGZpbHRlcihDdWx0aXZhciA9PSAiQUNBIDg2MSIpDQpgYGANCg0KPiBBY3RpdmlkYWQ6IEVzY3JpYmUgZWwgY8OzZGlnbyBuZWNlc2FyaW8gcGFyYSBmaWx0cmFyIHRvZG9zIGxvcyBlbnNheW9zIGRlIGxhIGxvY2FsaWRhZCBBbmd1aWwuDQoNCj4gQWN0aXZpZGFkOiBBaG9yYSBlc2NyaWJlIGVsIGPDs2RpZ28gcGFyYSBmaWx0cmFyIHRvZG9zIGxvcyBjdWx0aXZhcmVzIGNvbiB1biByZW5kaW1pZW50byBtYXlvciBhIDUwMDAga2cvaGEuDQoNCg==</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("04-data-manipulation.Rmd");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
